<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<base target="_blank" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Python</title>
<script type="text/javascript">
var userAgent = navigator.userAgent.toLowerCase();
var browser = 
	(browser = userAgent.match(/qqbrowser\/([\d.]+)/))?"qqbrowser/"+browser[1]:
	(browser = userAgent.match(/se\s+2.x/))?"sogou/2.x": //sougou
	(browser = userAgent.match(/msie\s+([\d.]+)/))?"msie/"+browser[1]: //ie
	(browser = userAgent.match(/chrome\/([\d.]+)/))?"chrome/"+browser[1]: //chrome
	(browser = userAgent.match(/firefox\/([\d.]+)/))?"firefox/"+browser[1]: //firefox
	(browser = userAgent.match(/version\/([\d.]+)\s+safari\/([\d.]+)/))?"safari/"+browser[1]: //safari
	(browser = userAgent.match(/opera\/([\d.]+)([\w\W]+)version\/([\d.]+)/))?"opera/"+browser[3]: //opera
	"other browser";
	var browser4 = browser.substr(0,2);
//实现回到页面顶部  
function goTopEx(){  
	var obj=document.getElementById("goTopBtn"); 
	var obj2=document.getElementById("shangy"); 
	var obj3=document.getElementById("xiay");
	var obj4=document.getElementById("goBottom");  
	
	function getScrollTop(){  
		if(browser4=="ch"){
			//谷歌浏览器
			//chrome63.0.3239.132对DTD XHTML 1.0不再支持body.scrollTop属性，只支持documentElement.scrollTop属
			return document.documentElement.scrollTop; 
		}else{
			//IE、firefox等浏览器 
			return document.documentElement.scrollTop;  
		}  
	}
	function setScrollTop(value){ 
		if(browser4=="ch"){ 
			//谷歌浏览器
			document.documentElement.scrollTop=value; 
		}else{  
			//IE、firefox等浏览器
			document.documentElement.scrollTop=value;  
		} 
	}     
	window.onscroll=function(){getScrollTop()>50?obj.style.display="":obj.style.display="none";
	getScrollTop()>100?obj2.style.display="":obj2.style.display="none";
	document.body.clientHeight-getScrollTop()>650?obj3.style.display="":obj3.style.display="none";
	document.body.clientHeight-getScrollTop()>650?obj4.style.display="":obj4.style.display="none";
	}  
	obj.onclick=function(){  
		var goTop=setInterval(scrollMove,10);  
		function scrollMove(){  
				setScrollTop(getScrollTop()/1.1);  
				if(getScrollTop()<1)clearInterval(goTop);  
		}  
	}  
}  
function downn(){
	if(browser4=="ch"){
		//谷歌浏览器
		window.scrollBy(0,document.body.clientHeight);
	}else{
		//IE、firefox等浏览器  
		window.scrollBy(0,document.documentElement.clientHeight*1000); 
	}
}document.write('<div style="position:fixed; right: 10px; top:20px; color:#eee;">背景颜色<br><select name=bcolor id=bcolor onchange="javascript:document.body.style.background=this.options[this.selectedIndex].value;"><option style="background-color: #ffffff" value="#ffffff">白色</option><option style="background-color: #f6f6f6" value="#f6f6f6">银灰</option><option style="background-color: #e4ebf1" value="#e4ebf1">淡蓝</option><option style="background-color: #e6f3ff" value="#e6f3ff">蓝色</option> <option style="background-color: #eeeeee" value="#eeeeee">淡灰</option><option style="background-color: #eaeaea" value="#eaeaea">灰色</option>  <option style="background-color: #e4e1d8" value="#e4e1d8">深灰</option><option style="background-color: #e6e6e6" value="#e6e6e6">暗灰</option><option style="background-color: #eefaee" value="#eefaee">绿色</option><option style="background-color: #ffffed" value="#ffffed">明黄</option><option style="background-color: #333333" value="#333333">黑色</option></select><br>字体颜色<br><select name=txtcolor id=txtcolor onchange="javascript:document.getElementById(\'container\').style.color=this.options[this.selectedIndex].value;"> <option value="#000000">黑色</option><option value="#ff0000">红色</option><option value="#006600">绿色</option><option value="#0000ff">蓝色</option><option value="#660000">棕色</option><option value="#ffffff">白色</option></select><br>字体大小<br><select name=fonttype id=fonttype onchange="javascript:document.getElementById(\'container\').style.fontSize=this.options[this.selectedIndex].value;"> <option value="12px" >小号</option> <option value="14px" >较小</option> <option value="19px" >中号</option> <option value="19px" >默认</option><option value="22px" >较大</option><option value="25px" >大号</option><option value="35px" >35px</option><option value="45px" >45px</option><option value="55px" >55px</option><option value="65px" >65px</option><option value="75px" >75px</option><option value="85px" >85px</option><option value="95px" >95px</option></select></div>');   
</script>
<style type="text/css">
#tbrowser a:linked container a:visited{
	font-size:18px;
	text-decoration:none;
}
a:link{
	text-decoration:none;
	}
#container{
	font-size:1.2em;
	margin:auto;
	font-family:"宋体";
	width:40em;
	line-height:1.6em;
}
P{
	margin-top:16px;
	margin-bottom:16px;
	text-indent:2em;
}
.uls{
	color:#CC6666;
	font-weight:bold;
}
.uls>ol{
	list-style:none;
	font-weight:normal;
	list-style:lower-latin;
	color:#000000;
	line-height:1.3em;
}
h2{
	font-size:20px;
	font-weight:bold;
	margin-top:15px;
	margin-bottom:0px;
	text-indent:0em;
}#goTopBtn, #goBottom, #shangy, #xiay, #ftsize1, #ftsize2, #ftsize3{
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    font-size: 12px;
    text-align: center;
    position: fixed;
	right: 10px;
    cursor: pointer;
    filter: Alpha(opacity=30);
	opacity=.3;
	font-weight:bold;
}
#goTopBtn, #goBottom, #ftsize1, #ftsize3  {
    background-color:#999;
    color:#000;
}
#shangy, #xiay, #ftsize2{
    background-color: #bbb;
    color: #000;
}
#ftsize1{
	bottom:240px;
}
#ftsize2{
	bottom:214px;
}
#ftsize3{
	bottom:188px;
}#goTopBtn{
    bottom: 105px;
}
#goBottom {
    bottom: 30px;
}
#shangy {
    bottom: 80px;
}
#xiay {
    bottom: 55px;
}
#goTopBtn:hover, #goBottom:hover, #shangy:hover, #xiay:hover, #ftsize1:hover, #ftsize2:hover, #ftsize3:hover{
	background-color:#ccc;
	border:#ccc 0px solid;
}
#goTopBtn a:link, #goBottom a:link, #xiay a:link, #shangy a:link, #ftsize1 a:link, #ftsize2 a:link, #ftsize3 a:link {
	text-decoration: none;
	color:white;
}
img{
	margin-right:2em;
	text-indent:2em;
	border:0;
}
.picsay{
	color:#930;
	font-size:90%;
	line-height:110%;
	margin-top:-12px;
	padding:0;
}
.remark{
	color:#930;
	font-size:90%;
	line-height:140%;
	margin-top:-12px;
	text-indent:0em;
	padding:0;
}
.ref{
	color:#930;
	font-size:95%;
	line-height:150%;
	margin-top:-12px;
	text-indent:2em;
	padding:0;
}
pre{
	font-size:120%;
	line-height:130%;
	padding:10px;
	//background-color:#f6f6f6;
	//background-color:#fff5ee;
	//background-color:#ffe;
	background-color:#eee;
	}
.code0, .code2, .code4{
	font-size:95%;
	line-height:110%;
	margin-top:-12px;
	padding:0;
	//background-color:#D9D1CA;
	//background-color:#f6f6f6;
	//background-color:#fff5ee;
	background-color:#ffe;
}
.code0{
	color:red;
	text-indent:0em;
}
.code2{
	color:#930;
	text-indent:2em;
}
.code4{
	color:blue;
	text-indent:4em;
}
sub,sup{
	font-size:80%;
	color:red;
}
</style></head><body onload="downn();">
<div>
<script type=text/javascript>
	goTopEx();
	function xiay(){
		window.scrollBy(0,window.innerHeight-10);
	}
	function shangy(){
		window.scrollBy(0,-window.innerHeight+10);
	}
	var obj3=document.getElementById("xiay");
	var obj4=document.getElementById("goBottom");
	function getHeight(){  
		if(browser4=="ch"){
			//谷歌浏览器
			return document.body.clientHeight; 
		}else{
			//IE、firefox等浏览器 
			return document.documentElement.clientHeight;  
		}  
	}
	getHeight()<window.innerHeight+50?obj3.style.display="none":obj3.style.display="";
	getHeight()<window.innerHeight+50?obj4.style.display="none":obj4.style.display="";
	//if(browser4!="ch"){	//firefox需要尝一下才显示向下图标
		xiay();
		shangy();
	//}
</script>
<a id="ftsizea" onclick='document.getElementById("container").style.fontSize = "1.4em";' target="_self" style="color:#fff;" title="大：1.4em"><div id="ftsize1" style="color:#fff;">大</div></a>
<a id="ftsizea" onclick='document.getElementById("container").style.fontSize = "1.2em";' target="_self" style="color:#fff;" title="中：1.2em"><div id="ftsize2" style="color:#fff;">中</div></a>
<a id="ftsizea" onclick='document.getElementById("container").style.fontSize = "1.0em";' target="_self" style="color:#fff;" title="小：1em"><div id="ftsize3" style="color:#fff;">小</div></a><a target="_self" style="color:#fff;"><div style="display:none; color:#fff;" id="goTopBtn">&and;</div></a>
<a onclick="shangy()" target="_self" style="color:#fff;"><div style="display:none; color:#fff;" id="shangy">&uarr;</div></a>
<a onclick="xiay()" target="_self" style="color:#fff;"><div id="xiay" style="color:#fff;">&darr;</div></a>
<a onclick="downn()" target="_self" style="color:#fff;"><div id="goBottom" style="color:#fff;">&or;</div></a></div>
<div id="container">
<script>
	goTopEx();
</script>


<p>用open()函数打开一个文件，就要向它传递一个字符串路径，表明希望打开的文件。这既可以是绝对路径，也可以是相对路径。open()函数返回一个File 对象。</p>
<p>文件被组织在文件夹中（也称为目录），路径描述了一个文件的位置。运行在计算机上的每个程序都有一个当前工作目录，它让你相对于当前的位置指定文件路径，而非总是需要完整路径（绝对路径）。os.path 模块包含许多函数，用于操作文件路径。</p>
<p>shutil（或称为shell 工具）模块中包含一些函数，让你在Python 程序中复制、移动、改名和删除文件。要使用shutil 的函数，首先需要import shutil。</p>
<p>可以导入os，使用函数os.getcwd()弄清楚当前工作目录是什么，并使用os.chdir()改变当前工作目录。</p>


<p>FILE *fp，文件指针代表一个指向文件开头的指针。</p>

<p>fp = fopen("d:\myfile.txt",'w');</p>


<p>数据可以存储成许多不同的格式和文档类型。某些格式存储的数据很容易被机器处理，如CSV、JSON、XML，而另一些格式则很被人工所读取，如Word.</p>

<p>CSV Comma-Separated Values 逗号分隔值；
<p>JSON JavaScript Object Notation JS对象符号；
<p>XML eXtensible Markup Language 可扩展标记语言；

<p>调用read()会一次性读取文件的全部内容，如果文件有10G，内存就爆了，所以，要保险起见，可以反复调用read(size)方法，每次最多读取size个字节的内容。另外，调用readline()可以每次读取一行内容，调用readlines()一次读取所有内容并按行返回list。因此，要根据需要决定怎么调用。</p>

<p>如果文件很小，read()一次性读取最方便；如果不能确定文件大小，反复调用read(size)比较保险；如果是配置文件，调用readlines()最方便。</p>


<p>read()方法在指定整数自变量的情况下会读取指定的字符数或字节数（视打开模式是文本模式还是二进制模式而定）。</p>

<p>对于文本模式来说，默认读到\n、\r、\r\n时，都可以被判定为一行，而readline()或readlines()读到的第一行的换行字符都一律换为\n；</p>

<p>对于二进制模式来说，行的判断标准默认是遇到b'\n'这个bytes类型。</p>

<p>文本模式在写入的情况下，任何'\n'都会被置换为os.linesep的值。（windows就是'\r\n')</p>

<p>readline在读不到下一行时会返回一个空字符串。</p>

<p>如果open()返回的文件对象都实现了__iter__()方法，可以返回一个迭代器，则在open()后可以直接用for方法迭代。</p>

<p>文件对象的tell()方法可以告诉文件指针的位移量，单位是字节数。seek()方法可以指定跳到哪个位移量。可以使用seek()实现文件的随机存取，文件的打开方式是'r+b'。</p>

<p>文件的打开模式的"+"表示读取与写入。</p>

<p>指定文本模式时默认采用locale.getprefered.encoding()的返回值作为文件编码，以windows简体中文版来说是返回CP936或bdk。如有某个.txt文件是以UTF-8编码并且有中文时，open()的参数必须指定编码方式为utf-8,如：open('test.txt', 'r', ' encoding="UTF-8")</p>

<p>UTF-8的编码方式是每个汉字使用三个字节，如1000个汉字就需要3KB的存储空间。</p>


<p>1 open</p>

<p>https://docs.python.org/3/library/functions.html#open</p>

<p>open(file, mode='r', buffering=-1, encoding=None, errors=None, newline=None, closefd=True, opener=None)</p>

<p>1.1 file </p>


<p>当程序运行时，变量是保存数据的好方法，但如果希望程序结束后数据仍然保持，就需要将数据保存到文件中。你可以认为文件的内容是一个字符串值，大小可能有几个GB。
<p>每个运行在计算机上的程序，都有一个“当前工作目录”，或cwd。所有没有从根文件夹开始的文件名或路径，都假定在当前工作目录下。利用os.getcwd()函数，可以取得当前工作路径的字符串，并可以利用os.chdir()改变它。
<p>>>> import os
<p>>>> os.getcwd()
<p>'C:\\Python34'
<p>>>> os.chdir('C:\\Windows\\System32')
<p>>>> os.getcwd()
<p>'C:\\Windows\\System32'
<p>有两种方法指定一个文件路径。
<p>“绝对路径”，总是从根文件夹开始。
<p>“相对路径”，它相对于程序的当前工作目录。
<p>还有点（.）和点点（..）文件夹。它们不是真正的文件夹，而是可以在路径中使用的特殊名称。单个的句点（“点”）用作文件夹目名称时，是“这个目录”的缩写。两个句点（“点点”）意思是父文件夹。
<p>程序可以用os.makedirs()函数创建新文件夹（目录）：
<p>>>> import os
<p>>>> os.makedirs('C:\\delicious\\walnut\\waffles')
<h4>读写文件</h4>
<p>“纯文本文件”只包含基本文本字符，不包含字体、大小和颜色信息。带有.txt 扩展名的文本文件，以及带有.py 扩展名的Python 脚本文件，都是纯文本文件的例子。它们可以被Windows 的Notepad 或OS X 的TextEdit应用打开。你的程序可以轻易地读取纯文本文件的内容，将它们作为普通的字符串值。
<p>“二进制文件”是所有其他文件类型，诸如字处理文档、PDF、图像、电子表格和可执行程序。
<p>在Python 中，读写文件有3 个步骤：
<p>1．调用open()函数，返回一个File 对象。
<p>2．调用File 对象的read()或write()方法。
<p>3．调用File 对象的close()方法，关闭该文件。

<p>shutil（或称为shell 工具）模块中包含一些函数，让你在Python 程序中复制、移动、改名和删除文件。要使用shutil 的函数，首先需要import shutil。
<p>利用os 模块中的函数，可以删除一个文件或一个空文件夹。但利用shutil 模块，可以删除一个文件夹及其所有的内容。
<p>os.walk()函数被传入一个字符串值，即一个文件夹的路径。你可以在一个for循环语句中使用os.walk()函数，遍历目录树，就像使用range()函数遍历一个范围的数字一样。不像range()，os.walk()在循环的每次迭代中，返回3 个值：
<p>1．当前文件夹名称的字符串。
<p>2．当前文件夹中子文件夹的字符串的列表。
<p>3．当前文件夹中文件的字符串的列表。

<p>和纯文本相比，.docx 文件有很多结构。这些结构在python-docx 中用3 种不同的类型来表示。在最高一层，Document 对象表示整个文档。Document 对象包含一个Paragraph 对象的列表，表示文档中的段落（用户在Word 文档中输入时，如果按下回车，新的段落就开始了）。每个Paragraph 对象都包含一个Run 对象的列表。
<p>Word 文档中的文本不仅仅是字符串。它包含与之相关的字体、大小、颜色和其他样式信息。在Word 中，样式是这些属性的集合。一个Run 对象是相同样式文本的延续。当文本样式发生改变时，就需要一个新的Run 对象。

<p>file可以是绝对路径，如'E:\\test.txt'</p>

<p>也可以是相对路径（相对于当前工作路径），如‘text.txt'</p>

<p>1.2 mode</p>

<p>mode是用来指定文件打开后的操作方式，如'r'是用来read(写），'w‘是指用来write（写，以覆盖旧内容的方式），'a'也是用来write（写，以追加内容的方式），'+'是指用来update(更新，读和写)。</p>

<p>文件可以以字符串的方式，也可以以二进制的方式来读写，分别用'b'和't'来指定。</p>

<p>mode的默认方式是‘rb'，也就是打开后以字符串的方式进行读操作。</p>

<pre>
# 有两个磁盘文件A和B,各存放一行字母,要求把这两个文件中的信息合并(按字母顺序排列), 输出到一个新文件C中。
f1str = "file1's str111.\n"
f2str = "file2's str222.\n"
with open('test1.txt', 'w') as f1:    
	f1.write(f1str)
with open('test2.txt', 'w') as f2:    
	f2.write(f2str)   
# import string
# 文件合并
fn1 = 'test1.txt'
fn2 = 'test2.txt'
fall = 'test3.txt'
with open(fn1) as fp:    
	a = fp.read()
with open(fn2) as fp:    
	b = fp.read()s = a +'\n' + b
with open(fall,'w') as fp:        
	fp.write(s)print(s)
</pre>

<p>对于简单的文本文件，唯一的结构层次是间隔的行。然而有时候需要更加结构化的文本，用于后续使用的程序保存数据或者向另外一个程序传送数据。</p>

<p>如CSV使用逗号分隔符，XML、HTML使用‘<’、‘>’标签。</p>

<p>许多程序提供多种选项和设置。动态的设置可以通过传入程序参数，但是持久的参数需要保存下来。</p>

<p>Excel、关系数据库是结构化二进制文件；</p>

<p>NoSQL数据存储，有些数据库并不是关系型的，不支持SQL。它们用来处理庞大的数据集、支持更加灵活的数据定义以及定制的数据操作。</p>

<p>openpyxl</p>
<p>调用get_sheet_names()方法可以取得工作簿中所有表名的列表。</p>
<p>每个表由一个Worksheet 对象表示，可以通过向工作簿方法get_sheet_by_name()传递表名字符串获得。最后，可以调用Workbook 对象的get_active_sheet()方法，取得工作簿的活动表。活动表是工作簿在Excel 中打开时出现的工作表。在取得Worksheet对象后，可以通过title 属性取得它的名称。</p>
<p>有了Worksheet 对象后，就可以按名字访问Cell 对象。</p>
<p>Cell 对象有一个value 属性，不出意外，它包含这个单元格中保存的值。Cell 对象也有row、column 和coordinate 属性，提供该单元格的位置信息。</p>
<p>为了定义单元格的字体风格，需要从openpyxl.styles 模块导入Font()和Style()函数。</p>
<p>sheet['B9'] = '=SUM(B1:B8)'</p>
<p>利用python-docx 模块，Python 可以创建和修改Word 文档，它带有.docx 文件扩展名。运行pip install python-docx，可以安装该模块（附录A 介绍了安装第三方模块的细节）。</p>
<p>和纯文本相比，.docx 文件有很多结构。这些结构在python-docx 中用3 种不同的类型来表示。在最高一层，Document 对象表示整个文档。Document 对象包含一个Paragraph 对象的列表，表示文档中的段落（用户在Word 文档中输入时，如果按下回车，新的段落就开始了）。每个Paragraph 对象都包含一个Run 对象的列表。</p>
<p>Word 文档中的文本不仅仅是字符串。它包含与之相关的字体、大小、颜色和其他样式信息。在Word 中，样式是这些属性的集合。一个Run 对象是相同样式文本的延续。当文本样式发生改变时，就需要一个新的Run 对象。</p>
<p>如果你只关心Word 文档中的文本，不关心样式信息，就可以利用getText()函数。它接受一个.docx 文件名，返回其中文本的字符串。</p>
<p>getText()函数打开了Word 文档，循环遍历paragraphs 列表中的所有Paragraph对象，然后将它们的文本添加到fullText 列表中。循环结束后，fullText 中的字符串连接在一起，中间以换行符分隔。</p>
<p>在处理PDF 和Word 文档时有很多限制，这是因为这些格式的本意是很好地展示给人看，而不是让软件易于解析。下一章将探讨存储信息的另外两种常见格式：JSON和CSV文件。这些格式是设计给计算机使用的。你会看到，Python 处理这些格式要容易得多。</p>
<p>CSV 表示“Comma-Separated Values（逗号分隔的值）”，CSV文件是简化的电子表格，保存为纯文本文件。Python 的csv 模块让解析CSV 文件变得容易。</p>
<p>JSON（发音为“JAY-sawn”或“Jason”，但如何发音并不重要。因为无论如何发音，都会有人说你发音错误）是一种格式，它以JavaScript 源代码的形式，将信息保存在纯文本文件中。</p>
<p>JSON 是JavaScript Object Notation 的缩写不需要知道JavaScript 编程语言，就可以使用JSON 文件，但了解JSON 格式是有用的，因为它用于许多Web 应用程序中。</p>
<p>要得到单独的线程，首先要调用threading.Thread()函数，生成一个Thread 对象。</p>
<p>图像由像素的集合构成，每个像素具有表示颜色的RGBA 值，可以通过x 和y坐标的定位。两种常见的图像格式是JPEG 和PNG。Pillow 模块可以处理这两种图像格式和其他格式。</p>


