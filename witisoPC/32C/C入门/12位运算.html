<<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<base target="_blank" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title></title>
<script type="text/javascript">
var userAgent = navigator.userAgent.toLowerCase();
var browser = 
	(browser = userAgent.match(/qqbrowser\/([\d.]+)/))?"qqbrowser/"+browser[1]:
	(browser = userAgent.match(/se\s+2.x/))?"sogou/2.x": //sougou
	(browser = userAgent.match(/msie\s+([\d.]+)/))?"msie/"+browser[1]: //ie
	(browser = userAgent.match(/chrome\/([\d.]+)/))?"chrome/"+browser[1]: //chrome
	(browser = userAgent.match(/firefox\/([\d.]+)/))?"firefox/"+browser[1]: //firefox
	(browser = userAgent.match(/version\/([\d.]+)\s+safari\/([\d.]+)/))?"safari/"+browser[1]: //safari
	(browser = userAgent.match(/opera\/([\d.]+)([\w\W]+)version\/([\d.]+)/))?"opera/"+browser[3]: //opera
	"other browser";
	var browser4 = browser.substr(0,2);
//实现回到页面顶部  
function goTopEx(){  
	var obj=document.getElementById("goTopBtn"); 
	var obj2=document.getElementById("shangy"); 
	var obj3=document.getElementById("xiay");
	var obj4=document.getElementById("goBottom");  
	
	function getScrollTop(){  
		if(browser4=="ch"){
			//chrome
			//chrome63.0.3239.132对DTD XHTML 1.0不再支持body.scrollTop属性，只支持documentElement.scrollTop 
			return document.documentElement.scrollTop; 
		}else{
			//IE、firefox
			return document.documentElement.scrollTop;  
		}  
	}
	function setScrollTop(value){ 
		if(browser4=="ch"){ 
			//chrome
			document.documentElement.scrollTop=value; 
		}else{  
			//IE、firefox
			document.documentElement.scrollTop=value;  
		} 
	}     
	window.onscroll=function(){getScrollTop()>50?obj.style.display="":obj.style.display="none";
	getScrollTop()>100?obj2.style.display="":obj2.style.display="none";
	document.body.clientHeight-getScrollTop()>650?obj3.style.display="":obj3.style.display="none";
	document.body.clientHeight-getScrollTop()>650?obj4.style.display="":obj4.style.display="none";
	}  
	obj.onclick=function(){  
		var goTop=setInterval(scrollMove,10);  
		function scrollMove(){  
				setScrollTop(getScrollTop()/1.1);  
				if(getScrollTop()<1)clearInterval(goTop);  
		}  
	}  
}  
function downn(){
	if(browser4=="ch"){
		//chrome
		window.scrollBy(0,document.body.clientHeight);
	}else{
		//IE、firefox
		window.scrollBy(0,document.documentElement.clientHeight*1000); 
	}
}
</script>
<script>
function changePage(){ 
	var page = document.getElementById("container");
	page.style.background="black";
	page.style.color="white";
	page.style.fontSize="22px";
	page.style.fontFamily="MV boli";
}
document.write('<div style="position:fixed; right: 10px; top:20px; color:#eee;">背景颜色<br><select name=bcolor id=bcolor onchange="javascript:document.body.style.background=this.options[this.selectedIndex].value;"><option style="background-color: #ffffff" value="#ffffff">白色</option><option style="background-color: #f6f6f6" value="#f6f6f6">银灰</option><option style="background-color: #e4ebf1" value="#e4ebf1">淡蓝</option><option style="background-color: #e6f3ff" value="#e6f3ff">蓝色</option> <option style="background-color: #eeeeee" value="#eeeeee">淡灰</option><option style="background-color: #eaeaea" value="#eaeaea">灰色</option>  <option style="background-color: #e4e1d8" value="#e4e1d8">深灰</option><option style="background-color: #e6e6e6" value="#e6e6e6">暗灰</option><option style="background-color: #eefaee" value="#eefaee">绿色</option><option style="background-color: #ffffed" value="#ffffed">明黄</option><option style="background-color: #333333" value="#333333">黑色</option></select><br>字体颜色<br><select name=txtcolor id=txtcolor onchange="javascript:document.getElementById(\'container\').style.color=this.options[this.selectedIndex].value;"> <option value="#000000">黑色</option><option value="#ff0000" style="color:red;">红色</option><option value="#006600" style="color:green;">绿色</option><option value="#0000ff" style="color:blue;">蓝色</option><option value="#660000" style="color:#006600;">棕色</option><option value="#ffffff">白色</option></select><br>字体大小<br><select name=fontsize id=fonttype onchange="javascript:document.getElementById(\'container\').style.fontSize=this.options[this.selectedIndex].value;"> <option value="12px" >小号</option> <option value="14px" >较小</option> <option value="19px" >中号</option> <option value="19px" >默认</option><option value="22px" >较大</option><option value="25px" >大号</option><option value="35px" >35px</option><option value="45px" >45px</option><option value="55px" >55px</option><option value="65px" >65px</option><option value="75px" >75px</option><option value="85px" >85px</option><option value="95px" >95px</option></select>><br>字体类型<br><select name=fonttype id=fonttype onchange="javascript:document.getElementById(\'container\').style.fontFamily=this.options[this.selectedIndex].value;"> <option value="宋体" >宋体</option> <option value="MV boli" style="font-family:MV boli">MV boli</option> <option value="隶书" style="font-family:隶书">隶书</option> <option value="黑体" style="font-family:黑体">黑体</option><option value="楷体" style="font-family:楷体">楷体</option><option value="幼圆" style="font-family:幼圆">幼圆</option><option value="华文中宋" style="font-family:华文中宋">华文中宋</option><option value="华文行楷" style="font-family:华文行楷">华文行楷</option><option value="微软雅黑" style="font-family:微软雅黑">微软雅黑</option><option value="Arial" style="font-family:Arial">Arial</option><option value="Vrinda" style="font-family:Vrinda">Vrinda</option><option value="Tahoma" style="font-family:Tahoma">Tahoma</option><option value="Courier" style="font-family:Courier">Courier</option><option value="Times" style="font-family:Times">Times</option><option value="Georgia" style="font-family:Georgia">Georgia</option><option value="Lucida" style="font-family:Lucida">Lucida</option></select><br><a onClick="changePage()" target="_self" id="changepage">黑底白字</a></div>');   
</script>
<style type="text/css">
#tbrowser a:linked container a:visited{
	font-size:18px;
	text-decoration:none;
}
a:link{
	text-decoration:none;
	}
#container{
	font-size:1.2em;
	margin:auto;
	font-family:"宋体";
	width:65.29%;
	line-height:1.6em;
}
P{
	margin-top:16px;
	margin-bottom:16px;
	text-indent:2em;
}
.uls{
	color:#CC6666;
	font-weight:bold;
}
.uls>ol{
	list-style:none;
	font-weight:normal;
	list-style:lower-latin;
	color:#000000;
	line-height:1.3em;
}
h3{
	font-size:1.1em;
	font-weight:bold;
	text-indent:0em;
	color:#990000;
}
h4{
	font-size:1.0em;
	font-weight:bold;
	text-indent:0em;
}

#goTopBtn, #goBottom, #shangy, #xiay, #ftsize1, #ftsize2, #ftsize3{
	width: 18px;
    line-height: 1.2;
    padding: 5px 0;
    font-size: 12px;
    text-align: center;
    position: fixed;
	right: 10px;
    cursor: pointer;
    filter: Alpha(opacity=30);
	opacity=.3;
	font-weight:bold;
}
#goTopBtn, #goBottom, #ftsize1, #ftsize3  {
    background-color:#999;
    color:#000;
}
#shangy, #xiay, #ftsize2{
    background-color: #bbb;
    color: #000;
}
#ftsize1{
	bottom:240px;
}
#ftsize2{
	bottom:214px;
}
#ftsize3{
	bottom:188px;
}

#goTopBtn{
    bottom: 105px;
}
#goBottom {
    bottom: 30px;
}
#shangy {
    bottom: 80px;
}
#xiay {
    bottom: 55px;
}
#goTopBtn:hover, #goBottom:hover, #shangy:hover, #xiay:hover, #ftsize1:hover, #ftsize2:hover, #ftsize3:hover{
	background-color:#ccc;
	border:#ccc 0px solid;
}
#goTopBtn a:link, #goBottom a:link, #xiay a:link, #shangy a:link, #ftsize1 a:link, #ftsize2 a:link, #ftsize3 a:link {
	text-decoration: none;
	color:white;
}
img{
	margin-right:2em;
	text-indent:2em;
	border:0;
}
.picsay{
	color:#930;
	font-size:90%;
	line-height:110%;
	margin-top:-12px;
	padding:0;
}
.remark{
	color:#930;
	font-size:90%;
	line-height:140%;
	margin-top:-12px;
	text-indent:0em;
	padding:0;
}
.ref{
	color:#930;
	font-size:95%;
	line-height:150%;
	margin-top:-12px;
	text-indent:2em;
	padding:0;
}
pre{
	font-size:120%;
	line-height:130%;
	padding:0;
	//background-color:#f6f6f6;
	//background-color:#fff5ee;
	//background-color:#ffe;
	background-color:#eee;
	padding:8px;
	margin-left:2em;
	color:blue;
	}
.code0, .code2, .code4{
	font-size:95%;
	line-height:110%;
	margin-top:-12px;
	padding:0;
	//background-color:#D9D1CA;
	//background-color:#f6f6f6;
	//background-color:#fff5ee;
	background-color:#ffe;
}
.code0{
	color:red;
	text-indent:0em;
}
.code2{
	color:#930;
	text-indent:2em;
}
.code4{
	color:blue;
	text-indent:4em;
}
sub,sup{
	font-size:80%;
	color:red;
}
table tr{
height:32px;
}
</style>
</head>

<body>

<div id="container">





<h4><a href="http://mallocfree.com/basic/c/c-12-bit.htm">12 位运算</a></h4>


<p>大家知道，程序中的数据在内存中，都是以二进制的形式存在的。所以，内存中的数据一般都是0和1组成的序列。所谓位运算就是直接对<strong>整数在内存中补码的二进制位</strong>进行操作。直接对二进制位进行操作，使得位运算比普通的运算操作效率要高。</p>
<p>关于位运算的操作分为：与(and)，或(or)，取反(not)，异或(xor)，左移(shl)，右移(shr/sar)等几种运算，它们共同构成了C语言中的位运算操作。</p>
<h4>12.1 二进制与位运算</h4>
<p>程序中的数据在内存中，都是以二进制的形式存在的。所以，内存中的数据一般都是0和1组成的序列。所谓位运算就是直接对整数在内存中的二进制位进行操作。直接对二进制位进行操作，使得位运算比普通的运算操作效率要高。</p>
<p>如下图所示，数据是用字节表示的，1个字节占8位。位运算就是直接对字节中的位进行运算。关于位运算的操作分为：与(and)，或(or)，取反(not)，异或(xor)，左移(shl)，右移(shr/sar)等几种运算，它们共同构成了C语言中的位运算操作。</p>
<img src="img/1201.jpg" />
<p>学习位运算的基础是掌握整数的补码存储与二进制表示方法，以及如何将一个十进制整数转化为二进制。详情请见第二章2.6/2.7节。</p>
<h4>12.2 与（&）运算</h4>
<p>与运算的操作符为&。2个数进行与运算时，就是将这2个数的二进制进行与操作，只有当2个数对应的位都为1，该位运算结果为1，否则运算结果为0。</p>
<img src="img/1202.gif" />
<p>即1&1 = 1，1&0 = 0。那么如何计算两个整数的与运算呢？比如计算15&10，首先15的二进制为：1111，10的二进制为1010，所以15&10为：</p>
<img src="img/1203.gif" />
<p>所以15&10=10。</p>
<pre>
int main(void)
{
    int a = 15;
    int b = 10;
    int c = 15&10;
    printf(“a&b=%d\n”, c);
    return 0;
}
</pre>
<h4>12.3 与（&）运算的应用</h4>
<p>与运算的性质：任何数&1都是它本身，&0是0。因此我们可以通过与运算来获取一个整数的某个部份的值，比如：</p>
<p>获取一个整数的后3位：</p>
<pre>
int x=100;
</pre>
<p>x&7即为x的后三位。因为7的二进制码为0111。所以，任何一个数与7进行与运算，那么其它位都会被置零。只有后三位得到保留。</p>
<p>我们也可以使用与运算与取反和移位运算相结合，将整数的某位置零。比如：</p>
<p>x&(~(1&lt;&lt;n))即可将x第n位置为零。</p>
<pre>
#define CLEARFLAG(a,n) ((a) &= ~(1&lt;&lt;(n)))//把整数a中第n位置为0
</pre>
<p>此外，我们还可以用来判断一个整数中某位是否为1（通常是某个标志信息），比如：</p>
<pre>
x&(1&lt;&lt;n);
</pre>
<p>上面的语句可以用来判断x中第n位是否为1。有时候一个整数通常用某1位或几位置1来表示一个信息，另几位表示另外的信息，这个时候用与运算就可以判断该位是否有该信息。</p>
<pre>
#define FLAGON(a,n) ((a)&(1&lt;&lt;(n)))//判断整数a中第n位是否为1
</pre>
<h4>12.4 或（|）运算</h4>
<p>或运算的操作符为|。2个数进行或运算时，就是将这2个数的二进制进行或操作，只要2个数对应的位有一个为1，该位运算结果为1，否则运算结果为0。</p>
<img src="img/1204.gif" />
<p>即1|1 = 1，1|0 = 1， 0|0 = 0。那么如何计算两个整数的或运算呢？比如计算15|10，首先15的二进制为：1111，10的二进制为1010，所以15|10为：</p>
<img src="img/1205.gif" />
<p>所以15|10=15。</p>
<pre>
int main(void)
{
    int a = 15;
    int b = 10;
    int c = 15|10;
    printf(“a|b=%d\n”, c);
    return 0;
}
</pre>
<h4>12.5 或（|）运算的应用</h4>
<p>或运算性质：任何一个数与1进行或运算为1，与0或运算为本身。可以利用此性质，将某个数的某位置1。</p>
<pre>
#define SETFLAG(a,n)  ((a) |= (1&lt;&lt;(n)))//把整数a中的第n位置为1
</pre>
<h4>12.6 取反（~）运算</h4>
<p>取反运算的操作符为~，为单目运算符。取反运算符顾名思义，就是将一个整数中位为1的变成0，位为0的变成1。</p>
<img src="img/1206.gif" />
<p>即~1 = 0，~0 = 1。那么如何计算1个整数的取反运算呢？比如计算~10，首先10的二进制为：1010，~10为：</p>
<img src="img/1207.gif" />
<p>所以~10=5。</p>
<p>int main(void)</p>
<p>{</p>
<p>    int a = 10;</p>
<p>    int b = ~10;</p>
<p>    printf(“~10=%d\n”, b);</p>
<p>    return 0;</p>
<p>}</p>
<h4>12.7 取反（~）运算的应用</h4>
<p>取反运算同与运算结合，可以将一个整数的某位置0，比如：</p>
<pre>
#define CLEARFLAG(a,n) ((a) &= ~(1&lt;&lt;(n)))//把整数a中第n位置为0
</pre>
<h4>12.8 异或（^）运算</h4>
<p>异或运算的操作符为^。2个数进行异或运算时，就是将这2个数的二进制进行异或操作，只要2个数对应的位相同，该位运算结果为0，否则运算结果为1。</p>
<img src="img/1209.gif" />
<p>即1^1 = 0，1^0 = 1， 0^0 = 0。那么如何计算两个整数的异或运算呢？比如计算15^10，首先15的二进制为：1111，10的二进制为1010，所以15^10为：</p>
<img src="img/1210.gif" />
<p>所以15^10=5。</p>
<pre>
int main(void)
{
    int a = 15;
    int b = 10;
    int c = 15^10;
    printf(“a^b=%d\n”, c);
    return 0;
}
</pre>
<h4>12.9 异或（^）运算的应用</h4>
<p>异或运算的性质：</p>
<pre>
a^a==0
a^0==a
</pre>
<p>即任何一个数与自身异或为0，与零异或为自身。</p>
<p>1 置零</p>
<p>利用这个性质，可以用于2个数的交换，置零等。</p>
<p>比如，我们在汇编语言里，经常看到这样的汇编语句：</p>
<pre>
xor eax,eax
</pre>
<p>这条汇编语句，利用异或性质，将eax置零。</p>
<p>2 交换2个数</p>
<p>异或另一个出名的应用是两个数的交换：</p>
<
<pre>
p>#define SWAP(a,b) \
do{\
    a=a^b;\
    b=a^b;\
    a=a^b;\
}while(0)&lt;/p
</pre>
<p>证明：</p>
<p>假设：a和b的初始值：a=a0,b=b0;</p>
<p>那么：</p>
<p>第一句：a=a^b即a为a0^b0</p>
<p>第二句：b=a^b即(a0^b0)^b0=》a0^(b0^b0)=》a0^0=》a0</p>
<p>第三句：a=a^b即a0^b0^a0=》a0^a0^b0=》0^b0=》b0</p>
<p>因此，通过上面的推导，实现了a与b值的交换。</p>
<p>3 单指针域构造双向链表</p>
<p>此外，异或还可以用在链表中，我们知道，通常的双向链表，需要在链表结点中设置2个指针，指向该结点的前驱和后继结点，但如果使用异或，则可以用单个指针域来表示双向链表：</p>
<p>有任意3个相邻结点：PL， P， PR</p>
<p>那么P->next = PL^PR</p>
<p>对于头结点来说：P没有左边的结点，所以左结点为NULL</p>
<p>所以Head->next = NULL^PR</p>
<p>对于尾结点来说：</p>
<p>尾结点没有右边的结点，所以PR为NULL</p>
<p>Tail->next = PL^NULL</p>
<p>那么在遍历的时候：</p>
<p>按照上述规则生成链表之后，遍历方法如下：</p>
<p>从左往右遍历链表：</p>
<pre>
pl=NULL;
p=Head;
while(p!=Tail)
{
    pr=pl^(p->next);
    pl=p;
    p=pr;
}
</pre>
<p>从右往左遍历链表：</p>
<pre>
pr=NULL;
p=Tail;
while(p!=Head)
{
    pl=pr^(p->next);
    pr=p;
    p=pl;
}
</pre>
<h4> 12.10左移（&lt;&lt;）运算</h4>
<p>左移运算符为&lt;&lt;。将一个数a向左移动n位记为：a&lt;&lt;n。比如将12向左移动2位如何计算呢？12的二进制为00001100，那么左移动2位为：00110000。无论左移还是右移，都需要用0或者1去填充移动之后空位。在左移的过程中，右边一律用0去填充。左移就没有右移那样分为逻辑右移和算术右移。</p>
<p>比如，将10左移2位，由于10的二进制为：00001010，那么左移2位，右边用零填充的结果为：00101000。</p>
<p>将一个数左移N位相当于将一个数乘以2^N，而将一个数右移N位相当于将这个数除以2^N。</p>
<pre>
int main(void)
{
    int a = 10;
    int b = a&lt;&lt;2;
    printf(“b=%d\n”, b);
    return 0;
}
</pre>
<p>上述位运算符的优先级列表如下：</p>
<img src="img/1221.jpg" />
<p>实际上，在讲解运算符的第5章就已经将各个运算符的优先级列了出来。因此，牢牢记住整个运算符的优先级，就没有问题。</p>
<h4>12.11 右移（>>）运算</h4>
<p>右移运算符为>>。将一个数a向右移动n位记为：a>>n。比如将12向右移动2位如何计算呢？12的二进制为00001100，那么右移动2位为：00000011，即3。</p>
<p>即12>>2为3。</p>
<p>右移动运算分为两种右移，一种为逻辑右移，在移动过程中，左边位用0填充。一种为算术右移，在移动过程中，左边用符号位来填充。</p>
<p>比如对于有符号数：10000011，对于逻辑右移，向右移动3位，那么左边用0填充，变成了：00010000。而对于算术右移，向右移动3位，那么左边用1（1为符号位）填充，变成了11110000。而对于01000011，算术右移3位，那么左边用0（0为符号位）填充，变成了00001000。</p>
<p>在C语言中，右移运算符为算术右移运算符，即左边用符号位来填充。</p>
<pre>
int main(void)
{
    int a = -3;
    int b = 10;
    int c = a &gt;&gt; 2;
    int d = b &gt;&gt;1;
    printf(“a&gt;&gt;2=%d, b&gt;&gt;1=%d\n”, c, d);
    return 0;
}
</pre>
<h4>12.12 位运算优先级</h4>
<p>    位运算符的优先级如下图，位置靠前的优先级高于位置靠后的优先级。</p>
<img src="img/1211.gif" />
<h4>12.13 常见位运算</h4>
<p>1．任何一个数和0异或是它的本身：</p>
<p>    a^0=a</p>
<p>    a^a=0</p>
<pre>
void swap(int *a, int *b)
{
   
    *a = *a ^ *b;
    *b = *a ^ *b;
    *a = *a ^ *b;
}
</pre>
<p>1）  将第n位置位或清零：</p>
<pre>
#define  BITN (1&lt;&lt;n)
置位：a |= BITN;
清零：a &= ~BITN
</pre>
<p>2）  清除整数a最右边的1。</p>
<p>方法：a & (a – 1)</p>
<p>    问题：如何判断判断整数x的二进制中含有多少个1？</p>
<p>    分析：此题是微软公司的一道笔试题。下面用&运算来解决此题。</p>
<p>    代码如下：</p>
<pre>
int func(int x )
{
    int countx = 0;
    while ( x )
    {
         countx ++;
         x = x&(x-1);
    }
    return countx;
}
</pre>
<table>
  <col width="190">
  <col width="190">
  <col width="179">
  <tr>
    <td>功能</td>
    <td>示例</td>
    <td>位运算</td>
  </tr>
  <tr>
    <td>去掉最后一位</td>
    <td>(101101-&gt;10110)</td>
    <td>x  &gt;&gt;  1</td>
  </tr>
  <tr>
    <td>在最后加一个0</td>
    <td>(101101-&gt;1011010)</td>
    <td>x  &lt;&lt;  1</td>
  </tr>
  <tr>
    <td>在最后加一个1</td>
    <td>(101101-&gt;1011011)</td>
    <td>(x  &lt;&lt;  1) + 1</td>
  </tr>
  <tr>
    <td>把最后一位变成1</td>
    <td>(101100-&gt;101101)</td>
    <td>x  |  1</td>
  </tr>
  <tr>
    <td>把最后一位变成0</td>
    <td>(101101-&gt;101100)</td>
    <td>(x  |  1) - 1</td>
  </tr>
  <tr>
    <td>最后一位取反</td>
    <td>(101101-&gt;101100)</td>
    <td>x  ^  1</td>
  </tr>
  <tr>
    <td>把右数第k位变成1</td>
    <td>(101001-&gt;101101,k=3)</td>
    <td>x  |  (1    &lt;&lt;  (k - 1))</td>
  </tr>
  <tr>
    <td>把右数第k位变成0</td>
    <td>(101101-&gt;101001,k=3)</td>
    <td>x  &amp;  ~ (1    &lt;&lt;  (k - 1))</td>
  </tr>
  <tr>
    <td>右数第k位取反</td>
    <td>(101001-&gt;101101,k=3)</td>
    <td>x  ^  (1  &lt;&lt;  (k    - 1))</td>
  </tr>
  <tr>
    <td>取末三位</td>
    <td>(1101101-&gt;101)</td>
    <td>x &amp; 7</td>
  </tr>
  <tr>
    <td>取末k位</td>
    <td>(1101101-&gt;1101,k=5)</td>
    <td>x  &amp;  ((1 &lt;&lt; k)    - 1)</td>
  </tr>
  <tr>
    <td>取右数第k位</td>
    <td>(1101101-&gt;1,k=4)</td>
    <td>x  &gt;&gt;  (k -    1)  &amp; 1</td>
  </tr>
  <tr>
    <td>把末k位变成1</td>
    <td>(101001-&gt;101111,k=4)</td>
    <td>x  |  ((1 &lt;&lt; k )-    1)</td>
  </tr>
  <tr>
    <td>末k位取反</td>
    <td>(101001-&gt;100110,k=4)</td>
    <td>x  ^  ((1    &lt;&lt;  k) - 1)</td>
  </tr>
  <tr>
    <td>去掉整数最右边的1</td>
    <td>(100101111-&gt;100101110)</td>
    <td>x  &amp;  (x – 1)</td>
  </tr>
  <tr>
    <td>把右边连续的1变成0</td>
    <td>(100101111-&gt;100100000)</td>
    <td>x  &amp;  (x + 1)</td>
  </tr>
  <tr>
    <td>把右起第一个0变成1</td>
    <td>(100101111-&gt;100111111)</td>
    <td>x  |  (x + 1)</td>
  </tr>
  <tr>
    <td>把右边连续的0变成1</td>
    <td>(11011000-&gt;11011111)</td>
    <td>x  |  (x - 1)</td>
  </tr>
  <tr>
    <td>去掉右起第一个1的左边</td>
    <td>(100101000-&gt;1000)</td>
    <td>x  &amp;  (x  ^  (x    - 1))</td>
  </tr>
  <tr>
    <td>取右边连续的1</td>
    <td>(100101111-&gt;1111)</td>
    <td>(x  ^  (x +    1))  &gt;&gt;  1</td>
  </tr>
</table>
<h4>12.14 位运算在软件工程中的运用</h4>
<p>在WDK中创建文件的IRP中，有一个Options整数，它的高8位记录了对文件的修改标记。因此可以使用下面的位运算来获取这8位的值：</p>
<pre>
ulDisposition = (lpIrpStack->Parameters.Create.Options &gt;&gt; 24) & 0xFF;
</pre>
<p>上面的语句中，先将该整数右移24位，再与0xFF做与运算，即可获得该8位的值。</p>
<p>此外，在实际应用中，会经常使用下面的宏定义来为一个整数设置，清除或者判断某些标志:</p>
<pre>
#define SETFLAG(a,n)  ((a) |= (1&lt;&lt;(n)))//把整数a中的第n位置为1
#define CLEARFLAG(a,n) ((a) &= ~(1&lt;&lt;(n)))//把整数a中第n位置为0
#define FLAGON(a,n) ((a)&(1&lt;&lt;(n)))//判断整数a中第n位是否为1&lt;
</pre>


<p style='float:right;'>本页共313段，7282个字符，12739 Byte(字节)</p>﻿




</div>


<div>
<a id="ftsizea" onclick='document.getElementById("container").style.fontSize = "1.4em";' target="_self" style="color:#fff;" title="大：1.4em"><div id="ftsize1" style="color:#fff;">大</div></a>
<a id="ftsizea" onclick='document.getElementById("container").style.fontSize = "1.2em";' target="_self" style="color:#fff;" title="中：1.2em"><div id="ftsize2" style="color:#fff;">中</div></a>
<a id="ftsizea" onclick='document.getElementById("container").style.fontSize = "1.0em";' target="_self" style="color:#fff;" title="小：1em"><div id="ftsize3" style="color:#fff;">小</div></a>

<a target="_self" style="color:#fff;"><div style="display:none; color:#fff;" id="goTopBtn">&and;</div></a>
<a onclick="shangy()" target="_self" style="color:#fff;"><div style="display:none; color:#fff;" id="shangy">&uarr;</div></a>
<a onclick="xiay()" target="_self" style="color:#fff;"><div id="xiay" style="color:#fff;">&darr;</div></a>
<a onclick="downn()" target="_self" style="color:#fff;"><div id="goBottom" style="color:#fff;">&or;</div></a>
<script type=text/javascript>
	goTopEx();
	function xiay(){
		window.scrollBy(0,window.innerHeight-10);
	}
	function shangy(){
		window.scrollBy(0,-window.innerHeight+10);
	}
	var obj3=document.getElementById("xiay");
	var obj4=document.getElementById("goBottom");
	function getHeight(){  
		if(browser4=="ch"){
			//谷歌浏览器
			return document.body.clientHeight; 
		}else{
			//IE、firefox等浏览器 
			return document.documentElement.clientHeight;  
		}  
	}
	getHeight()<window.innerHeight+50?obj3.style.display="none":obj3.style.display="";
	getHeight()<window.innerHeight+50?obj4.style.display="none":obj4.style.display="";
	if(browser4!="ch"){	//firefox需要尝一下才显示向下图标
		xiay();
		shangy();
	}
</script>
</div>

</body>
</html>
